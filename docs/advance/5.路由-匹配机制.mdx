---
title: 路由-匹配机制
hide_title: true
hide_table_of_contents: false
slug: route-match
---

:::note 什么是特殊路由匹配机制？

我们常说的 **匹配机制** 有：
- 全等匹配：略
- 头部匹配：略
- 尾部匹配：略
- 局部匹配：匹配局部信息
- 正则匹配：通过正则进行匹配

在路由管理中，**包含多种匹配模式**的机制我们都称之为特殊路由匹配机制。

:::

**特殊路由匹配机制** 是现代 web 框架必不可少的特点。

对于大多数的框架而言，它们都支持**正则匹配**，虽然这会带来更丰富的能力，但这无疑也会引入一定的性能问题。

Pywss 通过更简单、易懂的方式实现了三种路由匹配机制，包括：

|特殊路由匹配机制|说明|
|---|---|
|全等匹配|`app.get("/full/match", handler)`|
|局部匹配|`app.get("/partial/match/{name}", handler)`，注意，局部变量会存储在`ctx.route_params`中|
|头部匹配|`app.get("/head/match/*", handler)`，注意，此处需以 `*` 结尾|

**_注意_**：
上述匹配机制无法同时生效，且存在优先级，即 **全等匹配** > **局部匹配** > **头部匹配**

## 局部匹配 - 路径参数
Pywss 在路由配置时，通过中括号可以指定 **局部匹配**。

在指定 **局部匹配** 后会生成 **"路径参数"**，此参数可以在 `ctx.route_params` 中获取。

```python title="获取路径参数"
import pywss

def hello(ctx: pywss.Context):
    name = ctx.route_params["name"]
    ctx.write({"hello": name})

app = pywss.App()
app.get("/hello/{name}", hello)
app.run()
```

受限于实现机制，在局部匹配中**暂不支持对类型的校验**。

## 头部匹配
Pywss 在路由匹配时，通过在尾部配置 **`*`** 可以指定 **头部匹配**。

```python title="头部匹配"
import pywss

def hello(ctx: pywss.Context):
    name = ctx.route.replace("/hello", "", 1)
    ctx.write({"hello": name})

app = pywss.App()
app.get("/hello/*", hello)
app.run()
```
在此模式下，任意以 `/route/` 开头的路由均可以命中此路由。
